# k-Padre

This repository contains a suite of tools for analyzing allele-specific genomic data from hybrid samples. It includes tools for allelic read assignment on genomic, gene expression, and DNA-methylation data from bisulphite sequencing. It also includes a utility to model the effects of tissue contamination in quimeric tissues like placentas. K-Padre contains two bioinformatic pipelines for allelic assignments:

- Diploid genome comparison (for DNA and RNA reads): if genomes assemblies for both parents are available, this pipeline can be used to discriminate origin based on differences in alignment scores to each genome

- Diagnostic variants: If only one one genome assembly is available, k-Padre can assign allelic origin using a set of diagnostic variants
relative from the reference assembly

## Table of Contents

- [Features](#features)
- [Dependencies](#dependencies)
- [Installation](#installation)
  
- [Usage](#usage)
- [Input/Output Format](#inputoutput-format)
- [Examples](#examples)
- [License](#license)
- [Contact](#contact)

## Features

- Classifies genomic sequencing reads by allele 
- Supports DNA-methylation data generated by sulphite sequencing.
- Models the effect of tissue contamination on quimeric tissues.
- Compatible with HISAT2, and WGBS alignment tools

## Dependencies

This script requires [`samtools`](http://www.htslib.org/) to be installed. Samtools is included in the kPadre-env.yalm file for conda, but a custom installation can be used as long as samtools is in your system PATH.

## Installation

Clone the repository:

```bash
git clone https://github.com/LF_Rodriguez/kPadre.git
cd k-Padre

# Optional conda environment for samtools
conda env create -f kPadre-env.yml
conda activate kPadre-env
```
## Usage

### Pipeline 1: Diploid Genome Comparison

This pipeline compares two haplotypes to identify allele-specific signals.

```bash
# Create diploid genome
kPadre_creatediploid.py genome_1.fa genome_2.fa suffix_1 suffix_2 > diploid_genome.fa

# Run kPadre for diploid genome
kPadre.py -diploidGenome diploid_genome_alignment.sam suffix_1 suffix_2

```

### Pipeline 2: SNP-based allelic assignment
This pipeline uses known variants to one reference genome to assign allelic origin

```bash
# Select reference variants from VCF file
kPadre_select_snps.py genome_1.fa [-bs] variants.vcf > snp.txt

# Run kPadre for single genome
kPadre.py -singleGenome single_genome_alignment.sam snps.txt

```

## Inputoutput-format

## License

This software is released under the MIT License. You are free to use, modify, and distribute it with proper attribution.

**Disclaimer:** This tool is under active development and has not been extensively benchmarked or tested. Use at your own discretion, especially in production or clinical settings. Contributions and feedback are welcome to improve robustness and reproducibility.

## contact
lf.rdriguez027@gmail.com
